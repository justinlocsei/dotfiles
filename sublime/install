#!/bin/bash

CURRENT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "$CURRENT_DIR/../install-helpers"

SUBLIME_CMD="/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl"
SUBLIME_DIR="$HOME/Library/Application Support/Sublime Text 3/Packages/User"

if [[ -d "$SUBLIME_DIR" ]]; then
  perform_action "Removing existing Sublime preferences: $SUBLIME_DIR"
  rm -R "${SUBLIME_DIR:?}"
fi

ensure_symlink_exists "Sublime preferences" "$PWD/settings" "$SUBLIME_DIR"
ensure_symlink_exists "Sublime executable" "$SUBLIME_CMD" "$HOME/bin/sublime"
